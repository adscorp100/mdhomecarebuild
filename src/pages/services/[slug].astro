---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import EligibilityChecker from '../../components/EligibilityChecker.astro';
import { Icon } from 'astro-icon/components';

// Define TypeScript interfaces
interface SuburbInfo {
  state: string;
  region: string;
}

interface SuburbData {
  [key: string]: SuburbInfo;
}

interface SuburbWithName extends SuburbInfo {
  slug: string;
  name: string;
}

interface SuburbsByState {
  [key: string]: SuburbWithName[];
}

// Hardcode suburbs data
const suburbsData: SuburbData = {
  // Greater Sydney
  "sydney": { "state": "NSW", "region": "Greater Sydney" },
  "cbd": { "state": "NSW", "region": "Greater Sydney" },
  "haymarket": { "state": "NSW", "region": "Greater Sydney" },
  "the-rocks": { "state": "NSW", "region": "Greater Sydney" },
  "barangaroo": { "state": "NSW", "region": "Greater Sydney" },
  "pyrmont": { "state": "NSW", "region": "Greater Sydney" },
  "ultimo": { "state": "NSW", "region": "Greater Sydney" },
  "chippendale": { "state": "NSW", "region": "Greater Sydney" },
  "surry-hills": { "state": "NSW", "region": "Greater Sydney" },
  "darlinghurst": { "state": "NSW", "region": "Greater Sydney" },
  "potts-point": { "state": "NSW", "region": "Greater Sydney" },
  "elizabeth-bay": { "state": "NSW", "region": "Greater Sydney" },
  "rushcutters-bay": { "state": "NSW", "region": "Greater Sydney" },
  "woolloomooloo": { "state": "NSW", "region": "Greater Sydney" },
  "redfern": { "state": "NSW", "region": "Greater Sydney" },
  "waterloo": { "state": "NSW", "region": "Greater Sydney" },
  "zetland": { "state": "NSW", "region": "Greater Sydney" },
  "alexandria": { "state": "NSW", "region": "Greater Sydney" },
  "erskineville": { "state": "NSW", "region": "Greater Sydney" },

  // Eastern Suburbs
  "bondi": { "state": "NSW", "region": "Eastern Suburbs" },
  "bondi-beach": { "state": "NSW", "region": "Eastern Suburbs" },
  "bondi-junction": { "state": "NSW", "region": "Eastern Suburbs" },
  "bronte": { "state": "NSW", "region": "Eastern Suburbs" },
  "clovelly": { "state": "NSW", "region": "Eastern Suburbs" },
  "coogee": { "state": "NSW", "region": "Eastern Suburbs" },
  "maroubra": { "state": "NSW", "region": "Eastern Suburbs" },
  "kensington": { "state": "NSW", "region": "Eastern Suburbs" },
  "randwick": { "state": "NSW", "region": "Eastern Suburbs" },
  "vaucluse": { "state": "NSW", "region": "Eastern Suburbs" },
  "rose-bay": { "state": "NSW", "region": "Eastern Suburbs" },
  "double-bay": { "state": "NSW", "region": "Eastern Suburbs" },
  "bellevue-hill": { "state": "NSW", "region": "Eastern Suburbs" },
  "dover-heights": { "state": "NSW", "region": "Eastern Suburbs" },
  "queens-park": { "state": "NSW", "region": "Eastern Suburbs" },
  "pagewood": { "state": "NSW", "region": "Eastern Suburbs" },
  "eastgardens": { "state": "NSW", "region": "Eastern Suburbs" },
  "little-bay": { "state": "NSW", "region": "Eastern Suburbs" },
  "la-perouse": { "state": "NSW", "region": "Eastern Suburbs" },

  // Inner West
  "burwood": { "state": "NSW", "region": "Inner West" },
  "strathfield": { "state": "NSW", "region": "Inner West" },
  "newtown": { "state": "NSW", "region": "Inner West" },
  "marrickville": { "state": "NSW", "region": "Inner West" },
  "dulwich-hill": { "state": "NSW", "region": "Inner West" },
  "summer-hill": { "state": "NSW", "region": "Inner West" },
  "ashfield": { "state": "NSW", "region": "Inner West" },
  "leichhardt": { "state": "NSW", "region": "Inner West" },
  "balmain": { "state": "NSW", "region": "Inner West" },
  "rozelle": { "state": "NSW", "region": "Inner West" },
  "lilyfield": { "state": "NSW", "region": "Inner West" },
  "annandale": { "state": "NSW", "region": "Inner West" },
  "petersham": { "state": "NSW", "region": "Inner West" },
  "stanmore": { "state": "NSW", "region": "Inner West" },
  "enmore": { "state": "NSW", "region": "Inner West" },
  "croydon": { "state": "NSW", "region": "Inner West" },
  "croydon-park": { "state": "NSW", "region": "Inner West" },
  "haberfield": { "state": "NSW", "region": "Inner West" },
  "five-dock": { "state": "NSW", "region": "Inner West" },
  "drummoyne": { "state": "NSW", "region": "Inner West" },
  "glebe": { "state": "NSW", "region": "Inner West" },

  // North Shore
  "chatswood": { "state": "NSW", "region": "North Shore" },
  "st-leonards": { "state": "NSW", "region": "North Shore" },
  "artarmon": { "state": "NSW", "region": "Lower North Shore" },
  "willoughby": { "state": "NSW", "region": "Lower North Shore" },
  "naremburn": { "state": "NSW", "region": "Lower North Shore" },
  "northbridge": { "state": "NSW", "region": "Lower North Shore" },
  "cammeray": { "state": "NSW", "region": "Lower North Shore" },
  "cremorne": { "state": "NSW", "region": "Lower North Shore" },
  "neutral-bay": { "state": "NSW", "region": "Lower North Shore" },
  "mosman": { "state": "NSW", "region": "Lower North Shore" },
  "north-sydney": { "state": "NSW", "region": "Lower North Shore" },
  "kirribilli": { "state": "NSW", "region": "Lower North Shore" },
  "lavender-bay": { "state": "NSW", "region": "Lower North Shore" },
  "wollstonecraft": { "state": "NSW", "region": "Lower North Shore" },
  "greenwich": { "state": "NSW", "region": "Lower North Shore" },
  "lane-cove": { "state": "NSW", "region": "Lower North Shore" },
  "riverview": { "state": "NSW", "region": "Lower North Shore" },
  "longueville": { "state": "NSW", "region": "Lower North Shore" },

  // Upper North Shore
  "gordon": { "state": "NSW", "region": "Upper North Shore" },
  "killara": { "state": "NSW", "region": "Upper North Shore" },
  "lindfield": { "state": "NSW", "region": "Upper North Shore" },
  "roseville": { "state": "NSW", "region": "Upper North Shore" },
  "pymble": { "state": "NSW", "region": "Upper North Shore" },
  "turramurra": { "state": "NSW", "region": "Upper North Shore" },
  "wahroonga": { "state": "NSW", "region": "Upper North Shore" },
  "warrawee": { "state": "NSW", "region": "Upper North Shore" },
  "st-ives": { "state": "NSW", "region": "Upper North Shore" },
  "hornsby": { "state": "NSW", "region": "Upper North Shore" },
  "waitara": { "state": "NSW", "region": "Upper North Shore" },
  "asquith": { "state": "NSW", "region": "Upper North Shore" },
  "berowra": { "state": "NSW", "region": "Upper North Shore" },

  // Northern Suburbs
  "ryde": { "state": "NSW", "region": "Northern Sydney" },
  "eastwood": { "state": "NSW", "region": "Northern Sydney" },
  "epping": { "state": "NSW", "region": "Northern Sydney" },
  "macquarie-park": { "state": "NSW", "region": "Northern Sydney" },
  "north-ryde": { "state": "NSW", "region": "Northern Sydney" },
  "marsfield": { "state": "NSW", "region": "Northern Sydney" },
  "west-ryde": { "state": "NSW", "region": "Northern Sydney" },
  "meadowbank": { "state": "NSW", "region": "Northern Sydney" },
  "denistone": { "state": "NSW", "region": "Northern Sydney" },
  "putney": { "state": "NSW", "region": "Northern Sydney" },
  "gladesville": { "state": "NSW", "region": "Northern Sydney" },
  "hunters-hill": { "state": "NSW", "region": "Northern Sydney" },

  // Northern Beaches
  "manly": { "state": "NSW", "region": "Northern Beaches" },
  "dee-why": { "state": "NSW", "region": "Northern Beaches" },
  "brookvale": { "state": "NSW", "region": "Northern Beaches" },
  "freshwater": { "state": "NSW", "region": "Northern Beaches" },
  "curl-curl": { "state": "NSW", "region": "Northern Beaches" },
  "queenscliff": { "state": "NSW", "region": "Northern Beaches" },
  "fairlight": { "state": "NSW", "region": "Northern Beaches" },
  "balgowlah": { "state": "NSW", "region": "Northern Beaches" },
  "seaforth": { "state": "NSW", "region": "Northern Beaches" },
  "narrabeen": { "state": "NSW", "region": "Northern Beaches" },
  "collaroy": { "state": "NSW", "region": "Northern Beaches" },
  "avalon": { "state": "NSW", "region": "Northern Beaches" },
  "newport": { "state": "NSW", "region": "Northern Beaches" },
  "mona-vale": { "state": "NSW", "region": "Northern Beaches" },
  "palm-beach": { "state": "NSW", "region": "Northern Beaches" },

  // Hills District
  "castle-hill": { "state": "NSW", "region": "Hills District" },
  "baulkham-hills": { "state": "NSW", "region": "Hills District" },
  "bella-vista": { "state": "NSW", "region": "Hills District" },
  "kellyville": { "state": "NSW", "region": "Hills District" },
  "rouse-hill": { "state": "NSW", "region": "Hills District" },
  "pennant-hills": { "state": "NSW", "region": "Hills District" },
  "cherrybrook": { "state": "NSW", "region": "Hills District" },
  "west-pennant-hills": { "state": "NSW", "region": "Hills District" },
  "northmead": { "state": "NSW", "region": "Hills District" },
  "winston-hills": { "state": "NSW", "region": "Hills District" },
  "north-rocks": { "state": "NSW", "region": "Hills District" },
  "carlingford": { "state": "NSW", "region": "Hills District" },

  // Western Sydney
  "parramatta": { "state": "NSW", "region": "Western Sydney" },
  "penrith": { "state": "NSW", "region": "Western Sydney" },
  "blacktown": { "state": "NSW", "region": "Western Sydney" },
  "westmead": { "state": "NSW", "region": "Western Sydney" },
  "wentworthville": { "state": "NSW", "region": "Western Sydney" },
  "toongabbie": { "state": "NSW", "region": "Western Sydney" },
  "seven-hills": { "state": "NSW", "region": "Western Sydney" },
  "kings-langley": { "state": "NSW", "region": "Western Sydney" },
  "kings-park": { "state": "NSW", "region": "Western Sydney" },
  "prospect": { "state": "NSW", "region": "Western Sydney" },
  "girraween": { "state": "NSW", "region": "Western Sydney" },
  "pemulwuy": { "state": "NSW", "region": "Western Sydney" },
  "greystanes": { "state": "NSW", "region": "Western Sydney" },
  "merrylands": { "state": "NSW", "region": "Western Sydney" },
  "guildford": { "state": "NSW", "region": "Western Sydney" },
  "auburn": { "state": "NSW", "region": "Western Sydney" },
  "granville": { "state": "NSW", "region": "Western Sydney" },
  "harris-park": { "state": "NSW", "region": "Western Sydney" },
  "st-marys": { "state": "NSW", "region": "Western Sydney" },
  "mount-druitt": { "state": "NSW", "region": "Western Sydney" },
  "rooty-hill": { "state": "NSW", "region": "Western Sydney" },
  "doonside": { "state": "NSW", "region": "Western Sydney" },
  "quakers-hill": { "state": "NSW", "region": "Western Sydney" },

  // South Western Sydney
  "liverpool": { "state": "NSW", "region": "South Western Sydney" },
  "fairfield": { "state": "NSW", "region": "South Western Sydney" },
  "cabramatta": { "state": "NSW", "region": "South Western Sydney" },
  "bankstown": { "state": "NSW", "region": "South Western Sydney" },
  "revesby": { "state": "NSW", "region": "South Western Sydney" },
  "padstow": { "state": "NSW", "region": "South Western Sydney" },
  "punchbowl": { "state": "NSW", "region": "South Western Sydney" },
  "yagoona": { "state": "NSW", "region": "South Western Sydney" },
  "bass-hill": { "state": "NSW", "region": "South Western Sydney" },
  "chester-hill": { "state": "NSW", "region": "South Western Sydney" },
  "sefton": { "state": "NSW", "region": "South Western Sydney" },
  "birrong": { "state": "NSW", "region": "South Western Sydney" },
  "regents-park": { "state": "NSW", "region": "South Western Sydney" },
  "berala": { "state": "NSW", "region": "South Western Sydney" },
  "lidcombe": { "state": "NSW", "region": "South Western Sydney" },
  "condell-park": { "state": "NSW", "region": "South Western Sydney" },
  "greenacre": { "state": "NSW", "region": "South Western Sydney" },
  "chullora": { "state": "NSW", "region": "South Western Sydney" },
  "villawood": { "state": "NSW", "region": "South Western Sydney" },
  "canley-vale": { "state": "NSW", "region": "South Western Sydney" },
  "canley-heights": { "state": "NSW", "region": "South Western Sydney" },
  "warwick-farm": { "state": "NSW", "region": "South Western Sydney" },
  "casula": { "state": "NSW", "region": "South Western Sydney" },
  "prestons": { "state": "NSW", "region": "South Western Sydney" },
  "hoxton-park": { "state": "NSW", "region": "South Western Sydney" },
  "west-hoxton": { "state": "NSW", "region": "South Western Sydney" },
  "middleton-grange": { "state": "NSW", "region": "South Western Sydney" },

  // St George
  "hurstville": { "state": "NSW", "region": "St George" },
  "kogarah": { "state": "NSW", "region": "St George" },
  "rockdale": { "state": "NSW", "region": "St George" },
  "brighton-le-sands": { "state": "NSW", "region": "St George" },
  "sans-souci": { "state": "NSW", "region": "St George" },
  "ramsgate": { "state": "NSW", "region": "St George" },
  "monterey": { "state": "NSW", "region": "St George" },
  "dolls-point": { "state": "NSW", "region": "St George" },
  "sandringham": { "state": "NSW", "region": "St George" },
  "beverly-hills": { "state": "NSW", "region": "St George" },
  "kingsgrove": { "state": "NSW", "region": "St George" },
  "bexley": { "state": "NSW", "region": "St George" },
  "carlton": { "state": "NSW", "region": "St George" },
  "allawah": { "state": "NSW", "region": "St George" },
  "mortdale": { "state": "NSW", "region": "St George" },
  "penshurst": { "state": "NSW", "region": "St George" },
  "oatley": { "state": "NSW", "region": "St George" },

  // Sutherland Shire
  "cronulla": { "state": "NSW", "region": "Sutherland Shire" },
  "sutherland": { "state": "NSW", "region": "Sutherland Shire" },
  "miranda": { "state": "NSW", "region": "Sutherland Shire" },
  "caringbah": { "state": "NSW", "region": "Sutherland Shire" },
  "gymea": { "state": "NSW", "region": "Sutherland Shire" },
  "engadine": { "state": "NSW", "region": "Sutherland Shire" },
  "sylvania": { "state": "NSW", "region": "Sutherland Shire" },
  "jannali": { "state": "NSW", "region": "Sutherland Shire" },
  "como": { "state": "NSW", "region": "Sutherland Shire" },
  "oyster-bay": { "state": "NSW", "region": "Sutherland Shire" },
  "woolooware": { "state": "NSW", "region": "Sutherland Shire" },
  "loftus": { "state": "NSW", "region": "Sutherland Shire" },
  "yarrawarrah": { "state": "NSW", "region": "Sutherland Shire" },
  "grays-point": { "state": "NSW", "region": "Sutherland Shire" },
  "kirrawee": { "state": "NSW", "region": "Sutherland Shire" },
  "kareela": { "state": "NSW", "region": "Sutherland Shire" },
  "yowie-bay": { "state": "NSW", "region": "Sutherland Shire" },
  "lilli-pilli": { "state": "NSW", "region": "Sutherland Shire" },
  "port-hacking": { "state": "NSW", "region": "Sutherland Shire" },
  "newcastle": { "state": "NSW", "region": "Hunter Region" },
  "wollongong": { "state": "NSW", "region": "Illawarra" },
  "gosford": { "state": "NSW", "region": "Central Coast" },
  "bathurst": { "state": "NSW", "region": "Central West" },
  "tamworth": { "state": "NSW", "region": "New England" },
  "dubbo": { "state": "NSW", "region": "Central West" },
  "byron-bay": { "state": "NSW", "region": "Northern Rivers" },
  "melbourne": { "state": "VIC", "region": "Greater Melbourne" },
  "brunswick": { "state": "VIC", "region": "Inner North" },
  "footscray": { "state": "VIC", "region": "Inner West" },
  "brighton": { "state": "VIC", "region": "Bayside" },
  "geelong": { "state": "VIC", "region": "Barwon" },
  "ballarat": { "state": "VIC", "region": "Central Highlands" },
  "bendigo": { "state": "VIC", "region": "Loddon" },
  "frankston": { "state": "VIC", "region": "Mornington Peninsula" },
  "st-kilda": { "state": "VIC", "region": "Inner South" },
  "richmond": { "state": "VIC", "region": "Inner East" },
  "dandenong": { "state": "VIC", "region": "South East" },
  "werribee": { "state": "VIC", "region": "Western Melbourne" },
  "toorak": { "state": "VIC", "region": "Inner East" },
  "mildura": { "state": "VIC", "region": "Mallee" },
  "brisbane": { "state": "QLD", "region": "Greater Brisbane" },
  "gold-coast": { "state": "QLD", "region": "South East Queensland" },
  "sunshine-coast": { "state": "QLD", "region": "South East Queensland" },
  "cairns": { "state": "QLD", "region": "Far North Queensland" },
  "townsville": { "state": "QLD", "region": "North Queensland" },
  "toowoomba": { "state": "QLD", "region": "Darling Downs" },
  "mackay": { "state": "QLD", "region": "Central Queensland" },
  "rockhampton": { "state": "QLD", "region": "Central Queensland" },
  "bundaberg": { "state": "QLD", "region": "Wide Bay Burnett" },
  "hervey-bay": { "state": "QLD", "region": "Wide Bay Burnett" },
  "southport": { "state": "QLD", "region": "Gold Coast" },
  "west-end": { "state": "QLD", "region": "Inner Brisbane" },
  "fortitude-valley": { "state": "QLD", "region": "Inner Brisbane" },
  "perth": { "state": "WA", "region": "Greater Perth" },
  "fremantle": { "state": "WA", "region": "Greater Perth" },
  "joondalup": { "state": "WA", "region": "Northern Perth" },
  "mandurah": { "state": "WA", "region": "Peel" },
  "bunbury": { "state": "WA", "region": "South West" },
  "geraldton": { "state": "WA", "region": "Mid West" },
  "kalgoorlie": { "state": "WA", "region": "Goldfields-Esperance" },
  "broome": { "state": "WA", "region": "Kimberley" },
  "scarborough": { "state": "WA", "region": "Coastal Perth" },
  "subiaco": { "state": "WA", "region": "Inner Perth" },
  "adelaide": { "state": "SA", "region": "Greater Adelaide" },
  "glenelg": { "state": "SA", "region": "Western Adelaide" },
  "mount-gambier": { "state": "SA", "region": "Limestone Coast" },
  "whyalla": { "state": "SA", "region": "Eyre Peninsula" },
  "port-augusta": { "state": "SA", "region": "Far North" },
  "port-lincoln": { "state": "SA", "region": "Eyre Peninsula" },
  "victor-harbor": { "state": "SA", "region": "Fleurieu Peninsula" },
  "norwood": { "state": "SA", "region": "Eastern Adelaide" },
  "port-adelaide": { "state": "SA", "region": "Western Adelaide" },
  "hobart": { "state": "TAS", "region": "Greater Hobart" },
  "launceston": { "state": "TAS", "region": "Northern Tasmania" },
  "devonport": { "state": "TAS", "region": "North West" },
  "burnie": { "state": "TAS", "region": "North West" },
  "sandy-bay": { "state": "TAS", "region": "Greater Hobart" },
  "kingston": { "state": "TAS", "region": "Greater Hobart" },
  "darwin": { "state": "NT", "region": "Top End" },
  "alice-springs": { "state": "NT", "region": "Central Australia" },
  "palmerston": { "state": "NT", "region": "Top End" },
  "katherine": { "state": "NT", "region": "Katherine Region" },
  "nhulunbuy": { "state": "NT", "region": "East Arnhem" },
  "canberra": { "state": "ACT", "region": "Capital Region" },
  "belconnen": { "state": "ACT", "region": "North Canberra" },
  "woden": { "state": "ACT", "region": "South Canberra" },
  "tuggeranong": { "state": "ACT", "region": "South Canberra" },
  "gungahlin": { "state": "ACT", "region": "North Canberra" },
  "queanbeyan": { "state": "NSW", "region": "Capital Region" },
  "campbelltown": { "state": "NSW", "region": "Macarthur" }
};

// Generate static paths for all service pages
export async function getStaticPaths() {
  const serviceEntries = await getCollection('services');
  return serviceEntries.map(entry => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

// Get the service for the current page
const { entry } = Astro.props;
const { Content } = await entry.render();

// Format suburb name for display (convert slug to title case)
const formatSuburbName = (slug: string): string => {
  return slug
    .split('-')
    .map((word: string) => word.charAt(0).toUpperCase() + word.slice(1))
    .join(' ');
};

// Get related services in the same category
const allServices = await getCollection('services');
const relatedServices = allServices
  .filter(service =>
    service.data.category === entry.data.category &&
    service.slug !== entry.slug
  )
  .slice(0, 3);

// Group suburbs by state
const suburbsByState: SuburbsByState = {};
const stateNames: Record<string, string> = {
  "NSW": "New South Wales",
  "VIC": "Victoria",
  "QLD": "Queensland",
  "WA": "Western Australia",
  "SA": "South Australia",
  "TAS": "Tasmania",
  "NT": "Northern Territory",
  "ACT": "Australian Capital Territory"
};

Object.entries(suburbsData).forEach(([slug, info]) => {
  const fullState = stateNames[info.state] || info.state;
  if (!suburbsByState[fullState]) {
    suburbsByState[fullState] = [];
  }
  suburbsByState[fullState].push({ slug, name: formatSuburbName(slug), ...info });
});

// Sort suburbs alphabetically within each state
Object.keys(suburbsByState).forEach(state => {
  suburbsByState[state].sort((a: SuburbWithName, b: SuburbWithName) => a.name.localeCompare(b.name));
});

// Sort states
const sortedStates = Object.keys(suburbsByState).sort();

// Create a generic title and description with 'Australia' instead of {suburb}
const baseTitle = entry.data.title.replace(/{suburb}/g, 'Australia');
const genericDescription = entry.data.description.replace(/{suburb}/g, 'Australia');

// Optimized meta title - remove pipes and keep concise
const genericTitle = baseTitle.replace(/\s*\|.*$/, ''); // Remove anything after first pipe

// H1 title - can be slightly longer, benefit-focused
const h1Title = baseTitle.replace(/\s*\|.*$/, '');

// Build canonical URL
const canonicalUrl = `https://mdhomecare.com.au/services/${entry.slug}`;

// Build breadcrumb data
const breadcrumbs = [
  { name: 'Home', url: 'https://mdhomecare.com.au' },
  { name: 'Services', url: 'https://mdhomecare.com.au/services' },
  { name: genericTitle, url: canonicalUrl }
];

// Build BreadcrumbList schema
const breadcrumbSchema = {
  "@type": "BreadcrumbList",
  "itemListElement": breadcrumbs.map((item, index) => ({
    "@type": "ListItem",
    "position": index + 1,
    "name": item.name,
    ...(index < breadcrumbs.length - 1 ? { "item": item.url } : {})
  }))
};

// Build FAQ schema
const faqSchema = {
  "@type": "FAQPage",
  "mainEntity": [{
    "@type": "Question",
    "name": "What services are available through MD Home Care?",
    "acceptedAnswer": {
      "@type": "Answer",
      "text": "MD Home Care offers a comprehensive range of services including personal care, nursing care, allied health services, meal preparation, continence management, mobility equipment, transport assistance, home cleaning, home modifications, social support, and respite care. The exact services available may vary by location and individual needs."
    }
  }, {
    "@type": "Question",
    "name": "How do I access MD Home Care services?",
    "acceptedAnswer": {
      "@type": "Answer",
      "text": "To access our services, you can contact us directly through our website or phone. We'll assess your needs and discuss available services in your area. We can help connect you with appropriate funding options like NDIS, Home Care Packages, or private payment arrangements."
    }
  }, {
    "@type": "Question",
    "name": "What areas do you service?",
    "acceptedAnswer": {
      "@type": "Answer",
      "text": "We provide services across multiple regions in Australia. You can check service availability in your specific suburb by using our location search tool on the website. We're continuously expanding our service areas to help more people access quality care."
    }
  }, {
    "@type": "Question",
    "name": "What qualifications do your care workers have?",
    "acceptedAnswer": {
      "@type": "Answer",
      "text": "All our care workers are qualified professionals with relevant certifications in their fields. They undergo regular training, have current police checks, and are fully insured. Our team includes registered nurses, allied health professionals, and qualified support workers."
    }
  }, {
    "@type": "Question",
    "name": "How are services priced?",
    "acceptedAnswer": {
      "@type": "Answer",
      "text": "Service pricing varies depending on the type of service, duration, and funding arrangement (NDIS, Home Care Package, or private). We provide transparent pricing information and can discuss costs during your initial consultation. We work to ensure our services remain accessible and affordable."
    }
  }]
};

// Combine all schemas
const combinedSchema = {
  "@context": "https://schema.org",
  "@graph": [breadcrumbSchema, faqSchema]
};
---

<script type="application/ld+json" set:html={JSON.stringify(combinedSchema)}></script>

<BaseLayout
  title={genericTitle}
  description={genericDescription}
  canonical={canonicalUrl}
>
  <div class="w-full">
    <article>
      <!-- Hero Section -->
      <header class="relative min-h-[90vh] flex items-center justify-center overflow-hidden pt-32">
          <!-- Background Image with Overlay -->
          <div class="absolute inset-0 bg-cover bg-center bg-no-repeat bg-fixed top-0" style={entry.data.image ? `background-image: url(${entry.data.image})` : 'background-color: oklch(var(--b2))'}></div>
          <div class="absolute inset-0 bg-gradient-to-b from-black/30 via-black/10 to-base-100 top-0"></div>

          <!-- Glass Console Frame -->
          <div class="container-custom relative z-10 px-4 py-12">
            <div class="max-w-4xl mx-auto bg-white/80 backdrop-blur-xl rounded-[2.5rem] border border-white/50 shadow-2xl p-8 md:p-12 lg:p-16 text-center">

              <!-- Breadcrumb Navigation -->
              <nav class="mb-8" aria-label="Breadcrumb">
                <ol class="flex flex-wrap justify-center items-center gap-2 text-sm font-medium">
                  {breadcrumbs.map((item, index) => (
                    <li class="flex items-center">
                      {index > 0 && (
                        <Icon name="hugeicons:arrow-right-01" class="h-3.5 w-3.5 mx-2 text-base-content/40" />
                      )}
                      {index === breadcrumbs.length - 1 ? (
                        <span class="text-base-content/60 font-semibold">{item.name}</span>
                      ) : (
                        <a href={item.url} class="text-primary hover:underline transition-colors font-medium">{item.name}</a>
                      )}
                    </li>
                  ))}
                </ol>
              </nav>

              <!-- Title -->
              <h1 class="text-4xl md:text-6xl lg:text-7xl font-bold text-secondary mb-6 leading-[1.1] tracking-tight text-balance">
                {h1Title}
              </h1>

              <!-- Description -->
              <p class="text-xl text-secondary/70 font-medium mb-10 leading-relaxed max-w-2xl mx-auto text-balance">
                {genericDescription}
              </p>

              <!-- CTA Buttons -->
              <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="tel:+61863869999" class="btn btn-primary btn-lg rounded-full px-8 text-lg font-bold shadow-lg shadow-primary/20 hover:shadow-xl hover:shadow-primary/30 hover:-translate-y-1 transition-all duration-300">
                   <Icon name="hugeicons:call-02" class="h-6 w-6 mr-2" />
                   08 6386 9999
                </a>
                <a href="/contact#contact-form" class="btn btn-lg bg-white text-secondary border-2 border-base-200 hover:border-primary hover:text-primary rounded-full px-8 transition-all duration-300">
                  Send Message
                </a>
              </div>

               <!-- Trust Signal -->
              <div class="mt-10 pt-8 border-t border-base-200/50 flex justify-center items-center gap-2">
                 <div class="flex text-warning">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg>
                 </div>
                 <span class="text-sm font-semibold text-secondary/70">4.7 (45 verified reviews)</span>
              </div>

            </div>
          </div>
      </header>

      <!-- Eligibility Checker Template -->
      <div id="eligibility-checker-template" class="hidden">
        <EligibilityChecker />
      </div>

      <!-- Main Content -->
      <div class="max-w-4xl mx-auto px-4 py-20" id="learn-more">
        <div class="prose prose-lg max-w-none prose-headings:font-bold prose-h2:text-3xl prose-h2:text-secondary prose-p:text-secondary/70 prose-li:text-secondary/70" id="content-container">
          <Content />
        </div>

        <!-- CTA Banner -->
        <div class="bg-primary text-primary-content my-16 shadow-2xl shadow-primary/20 rounded-[2.5rem] p-8 md:p-12 relative overflow-hidden">
             <!-- Decorative blobs -->
            <div class="absolute top-0 right-0 -translate-y-1/2 translate-x-1/3 w-64 h-64 bg-white/10 rounded-full blur-3xl pointer-events-none"></div>
            <div class="absolute bottom-0 left-0 translate-y-1/2 -translate-x-1/3 w-64 h-64 bg-white/10 rounded-full blur-3xl pointer-events-none"></div>
            
          <div class="flex flex-col md:flex-row items-center justify-between w-full gap-8 relative z-10">
            <div class="text-center md:text-left">
              <h3 class="font-bold text-2xl md:text-3xl mb-2">Ready to experience our service?</h3>
              <p class="text-primary-content/90 text-lg">Contact us today to discuss how we can help you or your loved ones.</p>
            </div>
            <a href="/contact#contact-form" class="btn btn-lg bg-white text-primary border-none hover:bg-base-100 rounded-full px-8 shadow-lg shrink-0">
              Contact Us Today
            </a>
          </div>
        </div>
      </div>

      <!-- Locations Section -->
      <section class="bg-base-200 py-24 px-4 border-t border-base-200">
        <div class="max-w-5xl mx-auto">
          <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl font-bold text-secondary mb-4">Find this service in your area</h2>
            <p class="text-secondary/60 text-lg">
              Select your state to browse available locations
            </p>
          </div>

          <!-- Search Input -->
          <div class="max-w-lg mx-auto mb-12">
            <div class="relative">
              <div class="absolute left-6 top-1/2 -translate-y-1/2 text-base-content/40 pointer-events-none">
                <Icon name="hugeicons:search-01" class="h-6 w-6" />
              </div>
              <input
                type="text"
                id="suburb-search"
                placeholder="Search suburbs..."
                class="input input-lg w-full h-16 px-16 rounded-full border-2 border-base-200 bg-white shadow-sm focus:border-primary focus:ring-4 focus:ring-primary/10 focus:outline-none transition-all text-base text-center"
              />
            </div>
          </div>

          <!-- States Accordion -->
          <div class="space-y-3">
            {sortedStates.map((state, index) => (
              <div class="collapse collapse-arrow bg-white rounded-2xl shadow-sm border border-base-100 state-section overflow-hidden hover:shadow-md transition-shadow duration-300">
                <input type="checkbox" class="accordion-checkbox" />
                <div class="collapse-title font-bold text-lg text-secondary flex items-center justify-between gap-4 px-6 py-5">
                  <span class="flex items-center gap-3">
                    {state}
                    <span class="px-3 py-1 rounded-full bg-primary/10 text-primary text-xs font-bold border-none">
                      {suburbsByState[state].length}
                    </span>
                  </span>
                </div>
                <div class="collapse-content bg-white !pt-0">
                  <ul class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 px-6 pb-6 pt-2">
                    {suburbsByState[state].map((suburb) => (
                      <li class="suburb-item">
                        <a
                          href={`/services/${entry.slug}/${suburb.slug}`}
                          class="flex flex-col p-3 rounded-xl bg-transparent hover:bg-base-100 text-center transition-all duration-500 ease-out h-full group border border-transparent hover:border-base-200"
                        >
                          <span class="suburb-name font-medium text-secondary text-sm group-hover:text-primary transition-colors duration-300 mb-0.5">{suburb.name}</span>
                          <span class="region-name text-[10px] text-secondary/40 font-bold uppercase tracking-wider group-hover:text-secondary/60 transition-colors duration-300">{suburb.region}</span>
                        </a>
                      </li>
                    ))}
                  </ul>
                </div>
              </div>
            ))}
          </div>
        </div>
      </section>

      <!-- Related Services -->
      {relatedServices.length > 0 && (
        <aside class="max-w-6xl mx-auto py-24 px-4">
          <h2 class="text-3xl md:text-4xl font-bold text-center text-secondary mb-16">Related Services</h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            {relatedServices.map((service) => (
              <a href={`/services/${service.slug}`} class="card bg-white rounded-[2.5rem] shadow-lg shadow-base-200/50 border border-base-200 hover:border-primary/50 hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group overflow-hidden">
                 <div class="h-48 overflow-hidden relative">
                    <img src={service.data.image || '/assets/homecare.webp'} alt={service.data.title} class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" />
                    <div class="absolute inset-0 bg-black/10 group-hover:bg-transparent transition-colors"></div>
                </div>
                <div class="card-body p-8">
                  <h3 class="card-title text-xl font-bold text-secondary mb-3 group-hover:text-primary transition-colors">{service.data.title.replace(/{suburb}/g, 'Australia')}</h3>
                  <p class="text-secondary/60 text-sm line-clamp-3 leading-relaxed mb-6">{service.data.description.replace(/{suburb}/g, 'Australia')}</p>
                   <span class="text-primary font-bold text-sm inline-flex items-center gap-2 mt-auto">
                      Learn More 
                      <Icon name="hugeicons:arrow-right-01" class="h-4 w-4 transition-transform group-hover:translate-x-1" />
                    </span>
                </div>
              </a>
            ))}
          </div>
        </aside>
      )}

      <!-- Footer Navigation -->
      <footer class="max-w-6xl mx-auto py-12 px-4 border-t border-base-200">
        <div class="flex justify-center">
          <a href="/services" class="btn btn-ghost gap-2 rounded-full hover:bg-base-100 text-secondary/70 hover:text-primary transition-colors">
            <Icon name="hugeicons:arrow-left-01" class="h-5 w-5" />
            Back to Services
          </a>
        </div>
      </footer>
    </article>
  </div>
</BaseLayout>

<style>
  @reference "../../styles/global.css";
  /* iOS fix for background images */
  @supports (-webkit-touch-callout: none) {
    header {
      background-attachment: scroll !important;
    }
  }

  /* Prose styling enhancements */
  .prose h2 {
    @apply text-2xl md:text-3xl font-bold mt-12 mb-6 text-secondary border-b border-base-200 pb-4;
  }

  .prose h3 {
    @apply text-xl font-bold mt-10 mb-4 text-secondary;
  }

  .prose h4 {
    @apply text-lg font-bold mt-8 mb-3 text-secondary;
  }

  .prose p {
    @apply mb-6 text-secondary/70 leading-relaxed text-lg;
  }

  .prose ul, .prose ol {
    @apply mb-6 pl-6 space-y-2;
  }

  .prose ul {
    @apply list-disc marker:text-primary;
  }

  .prose ol {
    @apply list-decimal marker:text-primary font-bold;
  }

  .prose li {
    @apply mb-2 pl-2 text-secondary/70 text-lg;
  }

  .prose a {
    @apply link link-primary font-bold no-underline hover:underline;
  }

  .prose blockquote {
    @apply border-l-4 border-primary pl-6 py-4 my-8 bg-base-200 rounded-r-2xl italic text-xl text-secondary font-medium shadow-sm;
  }

  .prose code {
    @apply bg-base-100 px-2 py-1 rounded-md text-sm font-mono text-primary;
  }

  .prose img {
    @apply rounded-[2rem] shadow-xl my-10 w-full;
  }

  .prose hr {
    @apply border-base-200 my-12;
  }
</style>

<script>
interface Placeholders {
  [key: string]: string;
}

document.addEventListener('DOMContentLoaded', () => {
  const contentContainer = document.getElementById('content-container');
  if (contentContainer) {
    const replaceText = (element: Node, placeholders: Placeholders): void => {
      if (element instanceof HTMLElement && (element.tagName === 'SCRIPT' || element.tagName === 'STYLE')) return;

      if (element.nodeType === Node.TEXT_NODE && element.textContent) {
        let newText = element.textContent;
        for (const [find, replace] of Object.entries(placeholders)) {
          newText = newText.replace(new RegExp(find, 'g'), replace);
        }
        if (element.textContent !== newText) {
          element.textContent = newText;
        }
        return;
      }

      for (const child of element.childNodes) {
        replaceText(child, placeholders);
      }
    };

    replaceText(contentContainer, {
      '{suburb}': 'Australia',
      '{region}': 'all regions',
      '{state}': 'nationwide'
    });
  }

  // Inject eligibility checker after the second paragraph
  const injectEligibilityChecker = () => {
    const contentContainer = document.getElementById('content-container');
    const eligibilityTemplate = document.getElementById('eligibility-checker-template');

    if (contentContainer && eligibilityTemplate) {
      const paragraphs = contentContainer.querySelectorAll('p');

      if (paragraphs.length >= 2) {
        const eligibilityChecker = eligibilityTemplate.cloneNode(true) as HTMLElement;
        eligibilityChecker.id = 'eligibility-checker-injected';
        eligibilityChecker.classList.remove('hidden');
        eligibilityChecker.classList.add('my-12');

        const secondParagraph = paragraphs[1];
        if (secondParagraph.parentNode) {
          secondParagraph.parentNode.insertBefore(eligibilityChecker, secondParagraph.nextSibling);
        }
      }
    }
  };

  setTimeout(injectEligibilityChecker, 100);

    // Suburb search functionality
    const searchInput = document.getElementById('suburb-search') as HTMLInputElement;
    const accordionCheckboxes = document.querySelectorAll<HTMLInputElement>('.accordion-checkbox');

    if (searchInput) {
      searchInput.addEventListener('input', (e) => {
        const target = e.target as HTMLInputElement;
        const searchTerm = target.value.toLowerCase();
        const suburbItems = document.querySelectorAll<HTMLLIElement>('.suburb-item');

        suburbItems.forEach(item => {
          const suburbName = item.querySelector('.suburb-name')?.textContent?.toLowerCase() || '';
          const regionName = item.querySelector('.region-name')?.textContent?.toLowerCase() || '';

          if (searchTerm === '' || suburbName.includes(searchTerm) || regionName.includes(searchTerm)) {
            item.style.display = 'list-item';
          } else {
            item.style.display = 'none';
          }
        });

        document.querySelectorAll<HTMLElement>('.state-section').forEach(section => {
          const visibleSuburbs = Array.from(section.querySelectorAll<HTMLLIElement>('.suburb-item')).filter(
            item => item.style.display !== 'none'
          ).length;

          const checkbox = section.querySelector<HTMLInputElement>('.accordion-checkbox');

          if (visibleSuburbs === 0) {
            section.style.display = 'none';
            if (checkbox) checkbox.checked = false;
          } else {
            section.style.display = 'block';
            // Expand accordion if there's a search term and matches
            if (searchTerm.length > 0 && checkbox) {
              checkbox.checked = true;
            }
          }
        });

        // If search is cleared, collapse all accordions
        if (searchTerm === '') {
          accordionCheckboxes.forEach(cb => {
            cb.checked = false;
          });
        }
      });
    }

    // Accordion functionality - One at a time logic for checkboxes (only when not searching)
    accordionCheckboxes.forEach(checkbox => {
      checkbox.addEventListener('change', function() {
        const isSearching = searchInput && searchInput.value.trim().length > 0;
        if ((this as HTMLInputElement).checked && !isSearching) {
          accordionCheckboxes.forEach(cb => {
            if (cb !== this) {
              (cb as HTMLInputElement).checked = false;
            }
          });
        }
      });
    });
  });
</script>