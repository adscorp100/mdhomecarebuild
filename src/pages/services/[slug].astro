---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import EligibilityChecker from '../../components/EligibilityChecker.astro';

// Define TypeScript interfaces
interface SuburbInfo {
  state: string;
  region: string;
}

interface SuburbData {
  [key: string]: SuburbInfo;
}

interface SuburbWithName extends SuburbInfo {
  slug: string;
  name: string;
}

interface SuburbsByState {
  [key: string]: SuburbWithName[];
}

// Hardcode suburbs data
const suburbsData: SuburbData = {
  // Greater Sydney
  "sydney": { "state": "NSW", "region": "Greater Sydney" },
  "cbd": { "state": "NSW", "region": "Greater Sydney" },
  "haymarket": { "state": "NSW", "region": "Greater Sydney" },
  "the-rocks": { "state": "NSW", "region": "Greater Sydney" },
  "barangaroo": { "state": "NSW", "region": "Greater Sydney" },
  "pyrmont": { "state": "NSW", "region": "Greater Sydney" },
  "ultimo": { "state": "NSW", "region": "Greater Sydney" },
  "chippendale": { "state": "NSW", "region": "Greater Sydney" },
  "surry-hills": { "state": "NSW", "region": "Greater Sydney" },
  "darlinghurst": { "state": "NSW", "region": "Greater Sydney" },
  "potts-point": { "state": "NSW", "region": "Greater Sydney" },
  "elizabeth-bay": { "state": "NSW", "region": "Greater Sydney" },
  "rushcutters-bay": { "state": "NSW", "region": "Greater Sydney" },
  "woolloomooloo": { "state": "NSW", "region": "Greater Sydney" },
  "redfern": { "state": "NSW", "region": "Greater Sydney" },
  "waterloo": { "state": "NSW", "region": "Greater Sydney" },
  "zetland": { "state": "NSW", "region": "Greater Sydney" },
  "alexandria": { "state": "NSW", "region": "Greater Sydney" },
  "erskineville": { "state": "NSW", "region": "Greater Sydney" },

  // Eastern Suburbs
  "bondi": { "state": "NSW", "region": "Eastern Suburbs" },
  "bondi-beach": { "state": "NSW", "region": "Eastern Suburbs" },
  "bondi-junction": { "state": "NSW", "region": "Eastern Suburbs" },
  "bronte": { "state": "NSW", "region": "Eastern Suburbs" },
  "clovelly": { "state": "NSW", "region": "Eastern Suburbs" },
  "coogee": { "state": "NSW", "region": "Eastern Suburbs" },
  "maroubra": { "state": "NSW", "region": "Eastern Suburbs" },
  "kensington": { "state": "NSW", "region": "Eastern Suburbs" },
  "randwick": { "state": "NSW", "region": "Eastern Suburbs" },
  "vaucluse": { "state": "NSW", "region": "Eastern Suburbs" },
  "rose-bay": { "state": "NSW", "region": "Eastern Suburbs" },
  "double-bay": { "state": "NSW", "region": "Eastern Suburbs" },
  "bellevue-hill": { "state": "NSW", "region": "Eastern Suburbs" },
  "dover-heights": { "state": "NSW", "region": "Eastern Suburbs" },
  "queens-park": { "state": "NSW", "region": "Eastern Suburbs" },
  "pagewood": { "state": "NSW", "region": "Eastern Suburbs" },
  "eastgardens": { "state": "NSW", "region": "Eastern Suburbs" },
  "little-bay": { "state": "NSW", "region": "Eastern Suburbs" },
  "la-perouse": { "state": "NSW", "region": "Eastern Suburbs" },

  // Inner West
  "burwood": { "state": "NSW", "region": "Inner West" },
  "strathfield": { "state": "NSW", "region": "Inner West" },
  "newtown": { "state": "NSW", "region": "Inner West" },
  "marrickville": { "state": "NSW", "region": "Inner West" },
  "dulwich-hill": { "state": "NSW", "region": "Inner West" },
  "summer-hill": { "state": "NSW", "region": "Inner West" },
  "ashfield": { "state": "NSW", "region": "Inner West" },
  "leichhardt": { "state": "NSW", "region": "Inner West" },
  "balmain": { "state": "NSW", "region": "Inner West" },
  "rozelle": { "state": "NSW", "region": "Inner West" },
  "lilyfield": { "state": "NSW", "region": "Inner West" },
  "annandale": { "state": "NSW", "region": "Inner West" },
  "petersham": { "state": "NSW", "region": "Inner West" },
  "stanmore": { "state": "NSW", "region": "Inner West" },
  "enmore": { "state": "NSW", "region": "Inner West" },
  "croydon": { "state": "NSW", "region": "Inner West" },
  "croydon-park": { "state": "NSW", "region": "Inner West" },
  "haberfield": { "state": "NSW", "region": "Inner West" },
  "five-dock": { "state": "NSW", "region": "Inner West" },
  "drummoyne": { "state": "NSW", "region": "Inner West" },
  "glebe": { "state": "NSW", "region": "Inner West" },

  // North Shore
  "chatswood": { "state": "NSW", "region": "North Shore" },
  "st-leonards": { "state": "NSW", "region": "North Shore" },
  "artarmon": { "state": "NSW", "region": "Lower North Shore" },
  "willoughby": { "state": "NSW", "region": "Lower North Shore" },
  "naremburn": { "state": "NSW", "region": "Lower North Shore" },
  "northbridge": { "state": "NSW", "region": "Lower North Shore" },
  "cammeray": { "state": "NSW", "region": "Lower North Shore" },
  "cremorne": { "state": "NSW", "region": "Lower North Shore" },
  "neutral-bay": { "state": "NSW", "region": "Lower North Shore" },
  "mosman": { "state": "NSW", "region": "Lower North Shore" },
  "north-sydney": { "state": "NSW", "region": "Lower North Shore" },
  "kirribilli": { "state": "NSW", "region": "Lower North Shore" },
  "lavender-bay": { "state": "NSW", "region": "Lower North Shore" },
  "wollstonecraft": { "state": "NSW", "region": "Lower North Shore" },
  "greenwich": { "state": "NSW", "region": "Lower North Shore" },
  "lane-cove": { "state": "NSW", "region": "Lower North Shore" },
  "riverview": { "state": "NSW", "region": "Lower North Shore" },
  "longueville": { "state": "NSW", "region": "Lower North Shore" },

  // Upper North Shore
  "gordon": { "state": "NSW", "region": "Upper North Shore" },
  "killara": { "state": "NSW", "region": "Upper North Shore" },
  "lindfield": { "state": "NSW", "region": "Upper North Shore" },
  "roseville": { "state": "NSW", "region": "Upper North Shore" },
  "pymble": { "state": "NSW", "region": "Upper North Shore" },
  "turramurra": { "state": "NSW", "region": "Upper North Shore" },
  "wahroonga": { "state": "NSW", "region": "Upper North Shore" },
  "warrawee": { "state": "NSW", "region": "Upper North Shore" },
  "st-ives": { "state": "NSW", "region": "Upper North Shore" },
  "hornsby": { "state": "NSW", "region": "Upper North Shore" },
  "waitara": { "state": "NSW", "region": "Upper North Shore" },
  "asquith": { "state": "NSW", "region": "Upper North Shore" },
  "berowra": { "state": "NSW", "region": "Upper North Shore" },

  // Northern Suburbs
  "ryde": { "state": "NSW", "region": "Northern Sydney" },
  "eastwood": { "state": "NSW", "region": "Northern Sydney" },
  "epping": { "state": "NSW", "region": "Northern Sydney" },
  "macquarie-park": { "state": "NSW", "region": "Northern Sydney" },
  "north-ryde": { "state": "NSW", "region": "Northern Sydney" },
  "marsfield": { "state": "NSW", "region": "Northern Sydney" },
  "west-ryde": { "state": "NSW", "region": "Northern Sydney" },
  "meadowbank": { "state": "NSW", "region": "Northern Sydney" },
  "denistone": { "state": "NSW", "region": "Northern Sydney" },
  "putney": { "state": "NSW", "region": "Northern Sydney" },
  "gladesville": { "state": "NSW", "region": "Northern Sydney" },
  "hunters-hill": { "state": "NSW", "region": "Northern Sydney" },

  // Northern Beaches
  "manly": { "state": "NSW", "region": "Northern Beaches" },
  "dee-why": { "state": "NSW", "region": "Northern Beaches" },
  "brookvale": { "state": "NSW", "region": "Northern Beaches" },
  "freshwater": { "state": "NSW", "region": "Northern Beaches" },
  "curl-curl": { "state": "NSW", "region": "Northern Beaches" },
  "queenscliff": { "state": "NSW", "region": "Northern Beaches" },
  "fairlight": { "state": "NSW", "region": "Northern Beaches" },
  "balgowlah": { "state": "NSW", "region": "Northern Beaches" },
  "seaforth": { "state": "NSW", "region": "Northern Beaches" },
  "narrabeen": { "state": "NSW", "region": "Northern Beaches" },
  "collaroy": { "state": "NSW", "region": "Northern Beaches" },
  "avalon": { "state": "NSW", "region": "Northern Beaches" },
  "newport": { "state": "NSW", "region": "Northern Beaches" },
  "mona-vale": { "state": "NSW", "region": "Northern Beaches" },
  "palm-beach": { "state": "NSW", "region": "Northern Beaches" },

  // Hills District
  "castle-hill": { "state": "NSW", "region": "Hills District" },
  "baulkham-hills": { "state": "NSW", "region": "Hills District" },
  "bella-vista": { "state": "NSW", "region": "Hills District" },
  "kellyville": { "state": "NSW", "region": "Hills District" },
  "rouse-hill": { "state": "NSW", "region": "Hills District" },
  "pennant-hills": { "state": "NSW", "region": "Hills District" },
  "cherrybrook": { "state": "NSW", "region": "Hills District" },
  "west-pennant-hills": { "state": "NSW", "region": "Hills District" },
  "northmead": { "state": "NSW", "region": "Hills District" },
  "winston-hills": { "state": "NSW", "region": "Hills District" },
  "north-rocks": { "state": "NSW", "region": "Hills District" },
  "carlingford": { "state": "NSW", "region": "Hills District" },

  // Western Sydney
  "parramatta": { "state": "NSW", "region": "Western Sydney" },
  "penrith": { "state": "NSW", "region": "Western Sydney" },
  "blacktown": { "state": "NSW", "region": "Western Sydney" },
  "westmead": { "state": "NSW", "region": "Western Sydney" },
  "wentworthville": { "state": "NSW", "region": "Western Sydney" },
  "toongabbie": { "state": "NSW", "region": "Western Sydney" },
  "seven-hills": { "state": "NSW", "region": "Western Sydney" },
  "kings-langley": { "state": "NSW", "region": "Western Sydney" },
  "kings-park": { "state": "NSW", "region": "Western Sydney" },
  "prospect": { "state": "NSW", "region": "Western Sydney" },
  "girraween": { "state": "NSW", "region": "Western Sydney" },
  "pemulwuy": { "state": "NSW", "region": "Western Sydney" },
  "greystanes": { "state": "NSW", "region": "Western Sydney" },
  "merrylands": { "state": "NSW", "region": "Western Sydney" },
  "guildford": { "state": "NSW", "region": "Western Sydney" },
  "auburn": { "state": "NSW", "region": "Western Sydney" },
  "granville": { "state": "NSW", "region": "Western Sydney" },
  "harris-park": { "state": "NSW", "region": "Western Sydney" },
  "st-marys": { "state": "NSW", "region": "Western Sydney" },
  "mount-druitt": { "state": "NSW", "region": "Western Sydney" },
  "rooty-hill": { "state": "NSW", "region": "Western Sydney" },
  "doonside": { "state": "NSW", "region": "Western Sydney" },
  "quakers-hill": { "state": "NSW", "region": "Western Sydney" },

  // South Western Sydney
  "liverpool": { "state": "NSW", "region": "South Western Sydney" },
  "fairfield": { "state": "NSW", "region": "South Western Sydney" },
  "cabramatta": { "state": "NSW", "region": "South Western Sydney" },
  "bankstown": { "state": "NSW", "region": "South Western Sydney" },
  "revesby": { "state": "NSW", "region": "South Western Sydney" },
  "padstow": { "state": "NSW", "region": "South Western Sydney" },
  "punchbowl": { "state": "NSW", "region": "South Western Sydney" },
  "yagoona": { "state": "NSW", "region": "South Western Sydney" },
  "bass-hill": { "state": "NSW", "region": "South Western Sydney" },
  "chester-hill": { "state": "NSW", "region": "South Western Sydney" },
  "sefton": { "state": "NSW", "region": "South Western Sydney" },
  "birrong": { "state": "NSW", "region": "South Western Sydney" },
  "regents-park": { "state": "NSW", "region": "South Western Sydney" },
  "berala": { "state": "NSW", "region": "South Western Sydney" },
  "lidcombe": { "state": "NSW", "region": "South Western Sydney" },
  "condell-park": { "state": "NSW", "region": "South Western Sydney" },
  "greenacre": { "state": "NSW", "region": "South Western Sydney" },
  "chullora": { "state": "NSW", "region": "South Western Sydney" },
  "villawood": { "state": "NSW", "region": "South Western Sydney" },
  "canley-vale": { "state": "NSW", "region": "South Western Sydney" },
  "canley-heights": { "state": "NSW", "region": "South Western Sydney" },
  "warwick-farm": { "state": "NSW", "region": "South Western Sydney" },
  "casula": { "state": "NSW", "region": "South Western Sydney" },
  "prestons": { "state": "NSW", "region": "South Western Sydney" },
  "hoxton-park": { "state": "NSW", "region": "South Western Sydney" },
  "west-hoxton": { "state": "NSW", "region": "South Western Sydney" },
  "middleton-grange": { "state": "NSW", "region": "South Western Sydney" },

  // St George
  "hurstville": { "state": "NSW", "region": "St George" },
  "kogarah": { "state": "NSW", "region": "St George" },
  "rockdale": { "state": "NSW", "region": "St George" },
  "brighton-le-sands": { "state": "NSW", "region": "St George" },
  "sans-souci": { "state": "NSW", "region": "St George" },
  "ramsgate": { "state": "NSW", "region": "St George" },
  "monterey": { "state": "NSW", "region": "St George" },
  "dolls-point": { "state": "NSW", "region": "St George" },
  "sandringham": { "state": "NSW", "region": "St George" },
  "beverly-hills": { "state": "NSW", "region": "St George" },
  "kingsgrove": { "state": "NSW", "region": "St George" },
  "bexley": { "state": "NSW", "region": "St George" },
  "carlton": { "state": "NSW", "region": "St George" },
  "allawah": { "state": "NSW", "region": "St George" },
  "mortdale": { "state": "NSW", "region": "St George" },
  "penshurst": { "state": "NSW", "region": "St George" },
  "oatley": { "state": "NSW", "region": "St George" },

  // Sutherland Shire
  "cronulla": { "state": "NSW", "region": "Sutherland Shire" },
  "sutherland": { "state": "NSW", "region": "Sutherland Shire" },
  "miranda": { "state": "NSW", "region": "Sutherland Shire" },
  "caringbah": { "state": "NSW", "region": "Sutherland Shire" },
  "gymea": { "state": "NSW", "region": "Sutherland Shire" },
  "engadine": { "state": "NSW", "region": "Sutherland Shire" },
  "sylvania": { "state": "NSW", "region": "Sutherland Shire" },
  "jannali": { "state": "NSW", "region": "Sutherland Shire" },
  "como": { "state": "NSW", "region": "Sutherland Shire" },
  "oyster-bay": { "state": "NSW", "region": "Sutherland Shire" },
  "woolooware": { "state": "NSW", "region": "Sutherland Shire" },
  "loftus": { "state": "NSW", "region": "Sutherland Shire" },
  "yarrawarrah": { "state": "NSW", "region": "Sutherland Shire" },
  "grays-point": { "state": "NSW", "region": "Sutherland Shire" },
  "kirrawee": { "state": "NSW", "region": "Sutherland Shire" },
  "kareela": { "state": "NSW", "region": "Sutherland Shire" },
  "yowie-bay": { "state": "NSW", "region": "Sutherland Shire" },
  "lilli-pilli": { "state": "NSW", "region": "Sutherland Shire" },
  "port-hacking": { "state": "NSW", "region": "Sutherland Shire" },
  "newcastle": { "state": "NSW", "region": "Hunter Region" },
  "wollongong": { "state": "NSW", "region": "Illawarra" },
  "gosford": { "state": "NSW", "region": "Central Coast" },
  "bathurst": { "state": "NSW", "region": "Central West" },
  "tamworth": { "state": "NSW", "region": "New England" },
  "dubbo": { "state": "NSW", "region": "Central West" },
  "byron-bay": { "state": "NSW", "region": "Northern Rivers" },
  "melbourne": { "state": "VIC", "region": "Greater Melbourne" },
  "brunswick": { "state": "VIC", "region": "Inner North" },
  "footscray": { "state": "VIC", "region": "Inner West" },
  "brighton": { "state": "VIC", "region": "Bayside" },
  "geelong": { "state": "VIC", "region": "Barwon" },
  "ballarat": { "state": "VIC", "region": "Central Highlands" },
  "bendigo": { "state": "VIC", "region": "Loddon" },
  "frankston": { "state": "VIC", "region": "Mornington Peninsula" },
  "st-kilda": { "state": "VIC", "region": "Inner South" },
  "richmond": { "state": "VIC", "region": "Inner East" },
  "dandenong": { "state": "VIC", "region": "South East" },
  "werribee": { "state": "VIC", "region": "Western Melbourne" },
  "toorak": { "state": "VIC", "region": "Inner East" },
  "mildura": { "state": "VIC", "region": "Mallee" },
  "brisbane": { "state": "QLD", "region": "Greater Brisbane" },
  "gold-coast": { "state": "QLD", "region": "South East Queensland" },
  "sunshine-coast": { "state": "QLD", "region": "South East Queensland" },
  "cairns": { "state": "QLD", "region": "Far North Queensland" },
  "townsville": { "state": "QLD", "region": "North Queensland" },
  "toowoomba": { "state": "QLD", "region": "Darling Downs" },
  "mackay": { "state": "QLD", "region": "Central Queensland" },
  "rockhampton": { "state": "QLD", "region": "Central Queensland" },
  "bundaberg": { "state": "QLD", "region": "Wide Bay Burnett" },
  "hervey-bay": { "state": "QLD", "region": "Wide Bay Burnett" },
  "southport": { "state": "QLD", "region": "Gold Coast" },
  "west-end": { "state": "QLD", "region": "Inner Brisbane" },
  "fortitude-valley": { "state": "QLD", "region": "Inner Brisbane" },
  "perth": { "state": "WA", "region": "Greater Perth" },
  "fremantle": { "state": "WA", "region": "Greater Perth" },
  "joondalup": { "state": "WA", "region": "Northern Perth" },
  "mandurah": { "state": "WA", "region": "Peel" },
  "bunbury": { "state": "WA", "region": "South West" },
  "geraldton": { "state": "WA", "region": "Mid West" },
  "kalgoorlie": { "state": "WA", "region": "Goldfields-Esperance" },
  "broome": { "state": "WA", "region": "Kimberley" },
  "scarborough": { "state": "WA", "region": "Coastal Perth" },
  "subiaco": { "state": "WA", "region": "Inner Perth" },
  "adelaide": { "state": "SA", "region": "Greater Adelaide" },
  "glenelg": { "state": "SA", "region": "Western Adelaide" },
  "mount-gambier": { "state": "SA", "region": "Limestone Coast" },
  "whyalla": { "state": "SA", "region": "Eyre Peninsula" },
  "port-augusta": { "state": "SA", "region": "Far North" },
  "port-lincoln": { "state": "SA", "region": "Eyre Peninsula" },
  "victor-harbor": { "state": "SA", "region": "Fleurieu Peninsula" },
  "norwood": { "state": "SA", "region": "Eastern Adelaide" },
  "port-adelaide": { "state": "SA", "region": "Western Adelaide" },
  "hobart": { "state": "TAS", "region": "Greater Hobart" },
  "launceston": { "state": "TAS", "region": "Northern Tasmania" },
  "devonport": { "state": "TAS", "region": "North West" },
  "burnie": { "state": "TAS", "region": "North West" },
  "sandy-bay": { "state": "TAS", "region": "Greater Hobart" },
  "kingston": { "state": "TAS", "region": "Greater Hobart" },
  "darwin": { "state": "NT", "region": "Top End" },
  "alice-springs": { "state": "NT", "region": "Central Australia" },
  "palmerston": { "state": "NT", "region": "Top End" },
  "katherine": { "state": "NT", "region": "Katherine Region" },
  "nhulunbuy": { "state": "NT", "region": "East Arnhem" },
  "canberra": { "state": "ACT", "region": "Capital Region" },
  "belconnen": { "state": "ACT", "region": "North Canberra" },
  "woden": { "state": "ACT", "region": "South Canberra" },
  "tuggeranong": { "state": "ACT", "region": "South Canberra" },
  "gungahlin": { "state": "ACT", "region": "North Canberra" },
  "queanbeyan": { "state": "NSW", "region": "Capital Region" },
  "campbelltown": { "state": "NSW", "region": "Macarthur" }
};

// Generate static paths for all service pages
export async function getStaticPaths() {
  const serviceEntries = await getCollection('services');
  return serviceEntries.map(entry => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

// Get the service for the current page
const { entry } = Astro.props;
const { Content } = await entry.render();

// Format suburb name for display (convert slug to title case)
const formatSuburbName = (slug: string): string => {
  return slug
    .split('-')
    .map((word: string) => word.charAt(0).toUpperCase() + word.slice(1))
    .join(' ');
};

// Get related services in the same category
const allServices = await getCollection('services');
const relatedServices = allServices
  .filter(service =>
    service.data.category === entry.data.category &&
    service.slug !== entry.slug
  )
  .slice(0, 3);

// Group suburbs by state
const suburbsByState: SuburbsByState = {};
Object.entries(suburbsData).forEach(([slug, info]) => {
  if (!suburbsByState[info.state]) {
    suburbsByState[info.state] = [];
  }
  suburbsByState[info.state].push({ slug, name: formatSuburbName(slug), ...info });
});

// Sort suburbs alphabetically within each state
Object.keys(suburbsByState).forEach(state => {
  suburbsByState[state].sort((a: SuburbWithName, b: SuburbWithName) => a.name.localeCompare(b.name));
});

// Sort states
const sortedStates = Object.keys(suburbsByState).sort();

// Create a generic title and description with 'Australia' instead of {suburb}
const genericTitle = entry.data.title.replace(/{suburb}/g, 'Australia');
const genericDescription = entry.data.description.replace(/{suburb}/g, 'Australia');
---

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [{
    "@type": "Question",
    "name": "What services are available through MD Home Care?",
    "acceptedAnswer": {
      "@type": "Answer",
      "text": "MD Home Care offers a comprehensive range of services including personal care, nursing care, allied health services, meal preparation, continence management, mobility equipment, transport assistance, home cleaning, home modifications, social support, and respite care. The exact services available may vary by location and individual needs."
    }
  }, {
    "@type": "Question",
    "name": "How do I access MD Home Care services?",
    "acceptedAnswer": {
      "@type": "Answer",
      "text": "To access our services, you can contact us directly through our website or phone. We'll assess your needs and discuss available services in your area. We can help connect you with appropriate funding options like NDIS, Home Care Packages, or private payment arrangements."
    }
  }, {
    "@type": "Question",
    "name": "What areas do you service?",
    "acceptedAnswer": {
      "@type": "Answer",
      "text": "We provide services across multiple regions in Australia. You can check service availability in your specific suburb by using our location search tool on the website. We're continuously expanding our service areas to help more people access quality care."
    }
  }, {
    "@type": "Question",
    "name": "What qualifications do your care workers have?",
    "acceptedAnswer": {
      "@type": "Answer",
      "text": "All our care workers are qualified professionals with relevant certifications in their fields. They undergo regular training, have current police checks, and are fully insured. Our team includes registered nurses, allied health professionals, and qualified support workers."
    }
  }, {
    "@type": "Question",
    "name": "How are services priced?",
    "acceptedAnswer": {
      "@type": "Answer",
      "text": "Service pricing varies depending on the type of service, duration, and funding arrangement (NDIS, Home Care Package, or private). We provide transparent pricing information and can discuss costs during your initial consultation. We work to ensure our services remain accessible and affordable."
    }
  }]
}
</script>

<BaseLayout
  title={`${genericTitle} | MD Home Care`}
  description={genericDescription}
>
  <div class="w-full">
    <article>
      <!-- Hero Section -->
      <header
        class="relative min-h-[80vh] bg-cover bg-center bg-fixed flex items-center justify-center"
        style={entry.data.image ? `background-image: url(${entry.data.image})` : 'background-color: oklch(var(--b2))'}
      >
        <div class="absolute inset-0 bg-gradient-to-b from-black/20 to-black/40"></div>
        <div class="relative z-10 max-w-3xl mx-auto text-center px-4 py-12">
          <div class="card bg-base-100/80 backdrop-blur-lg shadow-2xl border border-base-200">
            <div class="card-body p-8 md:p-12">
              <!-- Category Badge -->
              <div class="flex justify-center mb-4">
                <span class="badge badge-primary badge-lg">{entry.data.category}</span>
              </div>

              <!-- Title -->
              <h1 class="text-3xl md:text-5xl font-extrabold text-base-content mb-4 leading-tight">
                {genericTitle}
              </h1>

              <!-- Description -->
              <p class="text-lg text-base-content/70 mb-6">
                {genericDescription}
              </p>

              <!-- CTA Buttons -->
              <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="tel:+61863869999" class="btn btn-primary btn-lg gap-2 animate-pulse">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                  </svg>
                  <span class="hidden sm:inline">08 6386 9999</span>
                  <span class="sm:hidden">Call Now</span>
                </a>
                <a href="/contact#contact-form" class="btn btn-outline btn-lg">
                  Send Message
                </a>
              </div>

              <!-- Trust Signal -->
              <div class="flex justify-center mt-6">
                <div class="flex flex-col items-center gap-1">
                  <div class="rating rating-md">
                    <input type="radio" class="mask mask-star-2 bg-warning" disabled />
                    <input type="radio" class="mask mask-star-2 bg-warning" disabled />
                    <input type="radio" class="mask mask-star-2 bg-warning" disabled />
                    <input type="radio" class="mask mask-star-2 bg-warning" disabled />
                    <input type="radio" class="mask mask-star-2 bg-warning" disabled checked />
                  </div>
                  <span class="text-sm text-base-content/60">4.7 (45 verified reviews)</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Eligibility Checker Template -->
      <div id="eligibility-checker-template" class="hidden">
        <EligibilityChecker />
      </div>

      <!-- Main Content -->
      <div class="max-w-4xl mx-auto px-4 py-12" id="learn-more">
        <div class="prose prose-lg max-w-none" id="content-container">
          <Content />
        </div>

        <!-- CTA Banner -->
        <div class="alert bg-gradient-to-r from-primary to-accent text-primary-content my-12 shadow-lg">
          <div class="flex flex-col md:flex-row items-center justify-between w-full gap-4">
            <div>
              <h3 class="font-bold text-xl">Ready to experience our service?</h3>
              <p class="text-primary-content/90">Contact us today to discuss how we can help you or your loved ones.</p>
            </div>
            <a href="/contact#contact-form" class="btn btn-outline btn-sm md:btn-md border-primary-content text-primary-content hover:bg-primary-content hover:text-primary">
              Contact Us
            </a>
          </div>
        </div>
      </div>

      <!-- Locations Section -->
      <section class="bg-base-200 py-16 px-4">
        <div class="max-w-6xl mx-auto">
          <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl font-bold text-base-content mb-4">Find this service in your area</h2>
            <p class="text-base-content/70 max-w-2xl mx-auto">
              Select your location to see specific information about this service in your suburb.
            </p>
          </div>

          <!-- Search Input -->
          <div class="max-w-xl mx-auto mb-12">
            <input
              type="text"
              id="suburb-search"
              placeholder="Search for your suburb..."
              class="input input-bordered input-lg w-full"
            />
          </div>

          <!-- States Grid -->
          <div class="space-y-12">
            {sortedStates.map(state => (
              <div class="state-section">
                <h3 class="text-2xl font-bold text-base-content mb-6 border-b border-base-300 pb-2">{state}</h3>
                <ul class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3">
                  {suburbsByState[state].map((suburb) => (
                    <li class="suburb-item">
                      <a
                        href={`/services/${entry.slug}/${suburb.slug}`}
                        class="card bg-base-100 shadow-sm hover:shadow-md transition-all duration-200 hover:-translate-y-0.5 border border-base-300 hover:border-primary"
                      >
                        <div class="card-body p-4">
                          <span class="suburb-name font-medium text-base-content">{suburb.name}</span>
                          <span class="region-name text-sm text-base-content/60">{suburb.region}</span>
                        </div>
                      </a>
                    </li>
                  ))}
                </ul>
              </div>
            ))}
          </div>
        </div>
      </section>

      <!-- Related Services -->
      {relatedServices.length > 0 && (
        <aside class="max-w-6xl mx-auto py-16 px-4">
          <h2 class="text-3xl font-bold text-center text-base-content mb-10">Related Services</h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            {relatedServices.map((service) => (
              <div class="card bg-base-100 shadow-md hover:shadow-xl transition-all duration-300 hover:-translate-y-1 border border-base-200 hover:border-primary">
                <div class="card-body">
                  <h3 class="card-title text-lg">{service.data.title.replace(/{suburb}/g, 'Australia')}</h3>
                  <p class="text-base-content/70 text-sm line-clamp-3">{service.data.description.replace(/{suburb}/g, 'Australia')}</p>
                  <div class="card-actions justify-end mt-4">
                    <a href={`/services/${service.slug}`} class="link link-primary font-semibold inline-flex items-center gap-1">
                      Learn More
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                      </svg>
                    </a>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </aside>
      )}

      <!-- Footer Navigation -->
      <footer class="max-w-6xl mx-auto py-8 px-4 border-t border-base-300">
        <div class="flex justify-center">
          <a href="/services" class="btn btn-ghost gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
            Back to Services
          </a>
        </div>
      </footer>
    </article>
  </div>
</BaseLayout>

<style>
  @reference "../../styles/global.css";
  /* iOS fix for background images */
  @supports (-webkit-touch-callout: none) {
    header {
      background-attachment: scroll !important;
    }
  }

  /* Prose styling enhancements */
  .prose h2 {
    @apply text-2xl font-bold mt-10 mb-4 text-base-content border-b border-base-300 pb-2;
  }

  .prose h3 {
    @apply text-xl font-semibold mt-8 mb-3 text-base-content;
  }

  .prose h4 {
    @apply text-lg font-semibold mt-6 mb-2 text-base-content;
  }

  .prose p {
    @apply mb-4 text-base-content;
  }

  .prose ul, .prose ol {
    @apply mb-4 pl-6;
  }

  .prose ul {
    @apply list-disc;
  }

  .prose ol {
    @apply list-decimal;
  }

  .prose li {
    @apply mb-2;
  }

  .prose a {
    @apply link link-primary;
  }

  .prose blockquote {
    @apply border-l-4 border-primary pl-4 py-2 my-6 bg-base-200 rounded-r-lg italic;
  }

  .prose code {
    @apply bg-base-200 px-1.5 py-0.5 rounded text-sm font-mono;
  }

  .prose pre {
    @apply bg-neutral text-neutral-content p-4 rounded-lg overflow-x-auto my-4;
  }

  .prose pre code {
    @apply bg-transparent p-0;
  }

  .prose table {
    @apply w-full border-collapse my-6;
  }

  .prose th, .prose td {
    @apply border border-base-300 px-4 py-2 text-left;
  }

  .prose th {
    @apply bg-base-200 font-semibold;
  }

  .prose img {
    @apply rounded-lg shadow-md my-6;
  }

  .prose hr {
    @apply border-base-300 my-8;
  }
</style>

<script>
interface Placeholders {
  [key: string]: string;
}

document.addEventListener('DOMContentLoaded', () => {
  const contentContainer = document.getElementById('content-container');
  if (contentContainer) {
    const replaceText = (element: Node, placeholders: Placeholders): void => {
      if (element instanceof HTMLElement && (element.tagName === 'SCRIPT' || element.tagName === 'STYLE')) return;

      if (element.nodeType === Node.TEXT_NODE && element.textContent) {
        let newText = element.textContent;
        for (const [find, replace] of Object.entries(placeholders)) {
          newText = newText.replace(new RegExp(find, 'g'), replace);
        }
        if (element.textContent !== newText) {
          element.textContent = newText;
        }
        return;
      }

      for (const child of element.childNodes) {
        replaceText(child, placeholders);
      }
    };

    replaceText(contentContainer, {
      '{suburb}': 'Australia',
      '{region}': 'all regions',
      '{state}': 'nationwide'
    });
  }

  // Inject eligibility checker after the second paragraph
  const injectEligibilityChecker = () => {
    const contentContainer = document.getElementById('content-container');
    const eligibilityTemplate = document.getElementById('eligibility-checker-template');

    if (contentContainer && eligibilityTemplate) {
      const paragraphs = contentContainer.querySelectorAll('p');

      if (paragraphs.length >= 2) {
        const eligibilityChecker = eligibilityTemplate.cloneNode(true) as HTMLElement;
        eligibilityChecker.id = 'eligibility-checker-injected';
        eligibilityChecker.classList.remove('hidden');
        eligibilityChecker.classList.add('my-8', 'py-8', 'border-y', 'border-base-300');

        const secondParagraph = paragraphs[1];
        if (secondParagraph.parentNode) {
          secondParagraph.parentNode.insertBefore(eligibilityChecker, secondParagraph.nextSibling);
        }
      }
    }
  };

  setTimeout(injectEligibilityChecker, 100);

  // Suburb search functionality
  const searchInput = document.getElementById('suburb-search') as HTMLInputElement;

  if (searchInput) {
    searchInput.addEventListener('input', (e) => {
      const target = e.target as HTMLInputElement;
      const searchTerm = target.value.toLowerCase();
      const suburbItems = document.querySelectorAll<HTMLLIElement>('.suburb-item');

      suburbItems.forEach(item => {
        const suburbName = item.querySelector('.suburb-name')?.textContent?.toLowerCase() || '';
        const regionName = item.querySelector('.region-name')?.textContent?.toLowerCase() || '';

        if (searchTerm === '' || suburbName.includes(searchTerm) || regionName.includes(searchTerm)) {
          item.style.display = 'list-item';
        } else {
          item.style.display = 'none';
        }
      });

      document.querySelectorAll<HTMLElement>('.state-section').forEach(section => {
        const visibleSuburbs = Array.from(section.querySelectorAll<HTMLLIElement>('.suburb-item')).filter(
          item => item.style.display !== 'none'
        ).length;

        section.style.display = visibleSuburbs === 0 ? 'none' : 'block';
      });
    });
  }
});
</script>
